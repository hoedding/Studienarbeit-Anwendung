\input{./content/definitions.tex}

\begin{document}
\begin{titlepage}
\begin{figure}
\makebox[\textwidth]{\includegraphics[page={1},width=\paperwidth]{./data/deckblatt.pdf}} \\
\end{figure}
\end{titlepage}
\clearpage
\begin{figure}
\makebox[\textwidth]{\includegraphics[page={2},width=\paperwidth]{./data/deckblatt.pdf}} \\
\end{figure}
\thispagestyle{empty} %Head löschen
\tableofcontents
\thispagestyle{empty}  
\chapter{Einleitung} \input{./content/einleitung.tex}
\chapter{Hauptteil}
\section{LED-Pixel} \input{./content/ledpixel.tex}
\section{Bewegungssensor} \input{./content/bewegungssensor.tex}

\section{Python-Server und Protokoll} \input{./content/serverprotokoll.tex}
\section{Kamera}
\subsection{PI-Kamera vs. Netzwerkkamera}
Bei Auslösen des System im Überwachungsmodus soll ein aktuelles Bild der Überwachungskamera an das jeweilige Sartphone gepusht werden. Es gibt zwei mögliche Kameratechniken, entweder eine direkt an den Raspberry Pi Angeschlossene oder eine, die im Netzwerk erreichbar ist. 
\paragraph{Raspberry Pi Cam} \\
Die Kameras für den Raspberry Pi können direkt an das Gerät angeschlossen werden. Meistens werden sie direkt über die GPIO Pins verbunden. Der Vorteil dieser Kameras ist, dass sie keine externe Stromversorgung benötigen und durch viele verschiedene Frameworks leicht anpassbar und verwaltbar sind. Der große Nachteil ist allerdings, dass die Kamera an dem Raspberry Pi angeschlossen werden muss, auf welchem auch der Server läuft. Da dieser aber möglich wettergeschützt (im Außenbereich) oder unauffällig (im Innenbereich) angebracht ist, lässt sich von diesen Positionen kaum eine effektive Überwachung realisieren. \\
Als Beispiel wäre ein von der Raspberry Pi Foundation empfohlene Kamera zu nennen: //TODO Beispielkamera
\paragraph{Netzwerkkamera} \\
Eine Netzwerkkamera oder auch IP-Kamera genannt befindet sich im Netzwerk und kann über eine Website oder App eingesehen und gesteuert werden. Der Vorteil ist, dass sie sich irgendwo befinden kann, solange sie im selben Netzwerk ist. Somit kann zum Beispiel eine wetterfeste Kamera im Außenbereich angebracht werden und der Server kann sich im geschützten Innenbereich befinden. \\
Der Nachteil besteht bei IP-Kameras darin, dass es keine einheitliche API zum Abgreifen des Videomaterials gibt. Eine mögliche Lösung wäre das Laden der HTML Seite über einen HTTP-Request und darauffolgend das Ausfiltern des Bildmaterials. Über diese Variante kann aber kein Video sondern nur temporäre Bilder geladen werden. Dies würde aber für eine Notification auf dem Smartphone ausreichen. \\\\
Für dieses Projekt wird eine IP-Kamera aufgrund von oben genannten Vorteilen verwendet.
\subsection{Ansteuerung}
\paragraph{Testcode HTTP-Request}
\paragraph{Implementierung}

\section{Anwendungsstruktur}
\subsection{Klassen und ihre Funktionen}
Die Klasse 'Center' stellt die zentrale Stelle in der Anwendung dar, an der alle Informationen zusammen laufen und verwaltet werden. In der Klasse 'Sensor' werden die einzelnen Bewegungssensoren überwacht. Falls eine Bewegung detektiert wird, so werden in 'Center' die notwendigen Methoden aufgerufen um die LEDs an- oder auszuschalten.\\
Die Klasse 'LED\_Control' verwaltet die eingerichteten LEDs und steuert diese. Hier werden auch die möglichen Effekte gesteuert. Die Methoden in dieser Klasse werden aus der Klasse 'Center' aufgerufen. Ein Zugriff in die andere Richtung ist nicht möglich. \\\\
Alle Serverfunktionaltitäten werden in der Klasse 'Server' bereitgestellt. Hier werden die Daten von Übertragungen empfangen und ausgewertet. Die Prüfung der Korrektheit der einzelnen Protokollbestandteile findet ebenfalls hier statt. Wenn alle Überprüfungen erfolgreich sind, werden die Befehle an 'Center' weiter gegeben und dort ausgeführt. Wenn eine Antwort notwendig ist, zum Beispiel eine Statusabfrage der App an den Server, so werden die Informationen von 'Center' gesammelt und dann von 'Server' verpackt und in korrektem Format an das Mobilgerät gesendet. \\\\
Informationen die für den Betrieb des Systems notwendig sind, werden in der 'Config.ini' gespeichert und können nur über die Klasse 'ConfigReader' abgerufen werden. Es werden Informationen wie Anzahl der LEDs, Passworthash oder Adresse der Netzwerkkamera abgespeichert. Die Konfigurationsdatei wird beim Installationsvorgang erstellt. \\\\
Abrufen von Bildmaterial von der Netzwerkkamera findet ausschließlich über die Klasse 'Cam' statt. Die Klasse ruft die Informationen ab und filtert das Bildmaterial. Somit geben die Methoden der Klasse nur ein Bild zurück. \\\\
In der Klasse 'Status' kann ein Status des Gesamtsystems in der Kommandozeile ausgegeben werden und über 'Log' können Informationen im Logfile gespeichert werden. \\\\
Einzelne Rückgabetypen von Methoden, sowie die Initialisierung von allen Klassen kann mit 'UNIT\_Test' getestet werden. \\\\

\begin{lstlisting}[caption=Ausgabe der Klasse UNIT\_Test, language=python, frame=single, breaklines=true,columns=fullflexible, commentstyle=\color{gray}\upshape, captionpos=b, numbers = left]
root@raspberrypi:/home/timo/Studienarbeit# python UNIT_Test.py 
test_Center (__main__.TestSequenceFunctions) ... ok
test_Effects (__main__.TestSequenceFunctions) ... ok
test_LEDControl (__main__.TestSequenceFunctions) ... ok
test_Sensor (__main__.TestSequenceFunctions) ... ok
test_Server (__main__.TestSequenceFunctions) ... ok
test_Status (__main__.TestSequenceFunctions) ... ok
test_camAdress_MUST_FAIL (__main__.TestSequenceFunctions) ... FAIL
test_camAvaible (__main__.TestSequenceFunctions) ... ok
test_getHashPass (__main__.TestSequenceFunctions) ... ok
test_getMotionPin1 (__main__.TestSequenceFunctions) ... ok
test_getNumberOfLED (__main__.TestSequenceFunctions) ... ok

=============================================
FAIL: test_camAdress_MUST_FAIL (__main__.TestSequenceFunctions)
--------------------------------------------
Traceback (most recent call last):
  File "UNIT_Test.py", line 67, in test_camAdress_MUST_FAIL
    self.assertEqual(resultTest, resultCorrect)
AssertionError: '192.168.2.205' != '123'

--------------------------------------------
Ran 11 tests in 1.873s
\end{lstlisting}
\section{Konfiguration und Installation}
\subsection{Konfiguration}
\subsection{Installation}

\section{iOS App}
\subsection{Konzept}
\subsection{...}
\subsection{...}

\chapter{Praktische Umsetzung}

\chapter{Kostenaufstellung}

\chapter{Fazit}

\addcontentsline{toc}{chapter}{Abbildungsverzeichnis}
\listoffigures

\begin{thebibliography}{xxxxxxxxxxxxxxxxxxx}
 \bibitem[I.]{eventbased}"'SWR Info - Zahlen, Daten, Fakten über den SWR"', \url{http://www.swr.de/unternehmen/unternehmen/kennzahlen/kennzahlen-organisation/-/id=12213420/did=12302978/nid=12213420/eqq46v/index.html}, 13.12.2013
%\bibitem[Thema]{Bezeichner}"'Überschrift"', \url{LINK}, Datum
\end{thebibliography}

 \end{document}

 